---
page_title: "morpheus_vsphere_mks_cluster Resource - terraform-provider-morpheus"
subcategory: ""
description: |-
  Provides an Morpheus Kubernetes Service (MKS) cluster on VMware vSphere resource
---

# morpheus_vsphere_mks_cluster

Provides an Morpheus Kubernetes Service (MKS) cluster on VMware vSphere resource

## Example Usage

```terraform
data "morpheus_group" "morpheus_lab" {
  name = "MORPHEUS"
}

data "morpheus_cloud" "morpheus_vsphere" {
  name = "MORPHEUSVCENTER"
}

data "morpheus_resource_pool" "vsphere_resource_pool" {
  name     = "Morpheus-Cluster"
  cloud_id = data.morpheus_cloud.morpheus_vsphere.id
}

data "morpheus_cloud_datastore" "vsphere_datastore" {
  name     = "datastore01"
  cloud_id = data.morpheus_cloud.morpheus_vsphere.id
}

data "morpheus_network" "vm_network" {
  name = "VM Network"
}

data "morpheus_network" "internal_network" {
  name = "Internal Network"
}

data "morpheus_plan" "master_nodes" {
  name           = "2 CPU, 8GB Memory"
  provision_type = "vmware"
}

data "morpheus_plan" "worker_nodes" {
  name           = "2 CPU, 16GB Memory"
  provision_type = "vmware"
}

data "morpheus_workflow" "example_workflow" {
  name = "Example Workflow"
}

resource "morpheus_vsphere_mks_cluster" "tf_example_vsphere_instance" {
  name                    = "tfvsphere"
  resource_prefix         = "vmpre"
  hostname_prefix         = "ospre"
  description             = "Terraform MKS cluster example"
  cloud_id                = data.morpheus_cloud.morpheus_vsphere.id
  group_id                = data.morpheus_group.morpheus_lab.id
  cluster_layout_id       = 244
  pod_cidr                = "172.20.0.0/16"
  service_cidr            = "172.30.0.0/16"
  workflow_id             = data.morpheus_workflow.example_workflow
  api_proxy_id            = 1
  cluster_repo_account_id = 1

  master_node_pool {
    plan_id          = data.morpheus_plan.master_nodes
    resource_pool_id = data.morpheus_resource_pool.vsphere_resource_pool

    network_interface {
      network_id = data.morpheus_network.vm_network
    }

    storage_volume {
      root         = true
      size         = 30
      name         = "root"
      storage_type = 1
      datastore_id = data.morpheus_cloud_datastore.vsphere_datastore
    }

    tags = {
      "app" = "mksmaster"
    }
  }

  worker_node_pool {
    count            = 3
    plan_id          = data.morpheus_plan.worker_nodes
    resource_pool_id = data.morpheus_resource_pool.vsphere_resource_pool

    network_interface {
      network_id = data.morpheus_network.vm_network
    }

    network_interface {
      network_id = data.morpheus_network.internal_network
    }

    storage_volume {
      root         = true
      size         = 30
      name         = "root"
      storage_type = 1
      datastore_id = data.morpheus_cloud_datastore.vsphere_datastore
    }

    storage_volume {
      root         = false
      size         = 15
      name         = "data"
      storage_type = 1
      datastore_id = data.morpheus_cloud_datastore.vsphere_datastore
    }

    tags = {
      "app" = "mksworker"
    }
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `cloud_id` (Number) The ID of the cloud associated with the cluster
- `cluster_layout_id` (Number) The ID of the cluster layout to provision the cluster from
- `group_id` (Number) The ID of the group associated with the cluster

### Optional

- `api_proxy_id` (Number) The ID of the api proxy associated with the cluster
- `cluster_repo_account_id` (Number) The ID of the cluster repo account associated with the cluster
- `description` (String) The user friendly description of the cluster
- `hostname_prefix` (String) The prefix used for the guest operating system hostname of the master and worker nodes
- `master_node_pool` (Block List, Max: 1) Master node pool configuration (see [below for nested schema](#nestedblock--master_node_pool))
- `name` (String) The name of the cluster
- `pod_cidr` (String) The cluster pod cidr (default - 172.20.0.0/16)
- `resource_prefix` (String) The prefix used for the virtual machine name of the master and worker nodes
- `service_cidr` (String) The cluster service cidr (default - 172.30.0.0/16)
- `timeouts` (Block, Optional) (see [below for nested schema](#nestedblock--timeouts))
- `worker_node_pool` (Block List, Max: 1) Worker node pool configuration (see [below for nested schema](#nestedblock--worker_node_pool))
- `workflow_id` (Number) The ID of the provisioning workflow to execute

### Read-Only

- `api_endpoint` (String) The API URL of the cluster
- `id` (String) The ID of the cluster
- `kubernetes_version` (String) The Kubernetes version of the cluster

<a id="nestedblock--master_node_pool"></a>
### Nested Schema for `master_node_pool`

Required:

- `plan_id` (Number) The ID of the service plan associated with the master nodes in the cluster

Optional:

- `network_interface` (Block List) The network interfaces to create for the cluster master nodes (see [below for nested schema](#nestedblock--master_node_pool--network_interface))
- `resource_pool_id` (Number) The ID of the resource pool to provision the cluster master nodes to
- `storage_volume` (Block List) The storage volumes to create for the cluster master nodes (see [below for nested schema](#nestedblock--master_node_pool--storage_volume))
- `tags` (Map of String) Tags to assign to the cluster master nodes

<a id="nestedblock--master_node_pool--network_interface"></a>
### Nested Schema for `master_node_pool.network_interface`

Required:

- `network_id` (Number) The ID of the network to assign the network interface to


<a id="nestedblock--master_node_pool--storage_volume"></a>
### Nested Schema for `master_node_pool.storage_volume`

Required:

- `datastore_id` (Number) The ID of the datastore
- `name` (String) The name of the volume
- `root` (Boolean) Whether the volume is the root volume of the instance
- `size` (Number) The size of the volume in GB
- `storage_type` (Number) The storage volume type ID

Read-Only:

- `uuid` (String) The storage volume uuid



<a id="nestedblock--timeouts"></a>
### Nested Schema for `timeouts`

Optional:

- `create` (String)
- `delete` (String)
- `read` (String)
- `update` (String)


<a id="nestedblock--worker_node_pool"></a>
### Nested Schema for `worker_node_pool`

Required:

- `count` (Number) The number of worker nodes
- `plan_id` (Number) The ID of the service plan associated with the worker nodes in the cluster

Optional:

- `network_interface` (Block List) The network interfaces to create for the cluster worker nodes (see [below for nested schema](#nestedblock--worker_node_pool--network_interface))
- `resource_pool_id` (Number) The ID of the resource pool to provision the cluster worker nodes to
- `storage_volume` (Block List) The storage volumes to create for the cluster worker nodes (see [below for nested schema](#nestedblock--worker_node_pool--storage_volume))
- `tags` (Map of String) Tags to assign to the cluster worker nodes

<a id="nestedblock--worker_node_pool--network_interface"></a>
### Nested Schema for `worker_node_pool.network_interface`

Required:

- `network_id` (Number) The ID of the network to attach the interface to


<a id="nestedblock--worker_node_pool--storage_volume"></a>
### Nested Schema for `worker_node_pool.storage_volume`

Required:

- `datastore_id` (Number) The ID of the datastore
- `name` (String) The name of the volume
- `root` (Boolean) Whether the volume is the root volume of the instance
- `size` (Number) The size of the volume in GB
- `storage_type` (Number) The storage volume type ID

Read-Only:

- `uuid` (String) The storage volume uuid

## Import

Import is supported using the following syntax:

```shell
terraform import morpheus_vsphere_mks_cluster.tf_example_vsphere_mks_cluster 1
```
